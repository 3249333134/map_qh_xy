{"version":3,"file":"index.js","sources":["pages/index/index.vue","pages/index/index.vue?type=page"],"sourcesContent":["<template>\r\n  <view class=\"container\">\r\n    <!-- 地图区域 -->    \r\n    <map-background \r\n      :height=\"mapHeight\"\r\n      :config=\"mapConfig\"\r\n    />\r\n    \r\n    <!-- 可滑动区域 -->\r\n    <content-area \r\n      :height=\"contentHeight\"\r\n      :search-box-height=\"searchBoxHeight\"\r\n      :min-content-height=\"minContentHeight\"\r\n      :categories=\"categories\"\r\n      :active-category=\"activeCategory\"\r\n      :left-column-heights=\"leftColumnHeights\"\r\n      :right-column-heights=\"rightColumnHeights\"\r\n      :left-column-data=\"leftColumnData\"\r\n      :right-column-data=\"rightColumnData\"\r\n      :is-loading=\"isLoading\"\r\n      @drag-start=\"handleDragStart\"\r\n      @drag=\"handleDrag\"\r\n      @drag-end=\"handleDragEnd\"\r\n      @waterfall-scroll=\"handleWaterfallScroll\"\r\n      @category-change=\"handleCategoryChange\"\r\n      @search-input=\"onSearchInput\"\r\n      @load-more=\"loadMoreItems\"\r\n    />\r\n  </view>\r\n</template>\r\n\r\n<script>\r\n// 导入工具函数和常量\r\nimport { LAYOUT_CONFIG } from './constants/layoutConfig.js'\r\n// 导入MongoDB配置\r\nimport { MONGO_CONFIG } from '../../utils/db.js'\r\n// 导入组件\r\nimport MapBackground from './components/MapBackground.vue'\r\nimport ContentArea from './components/ContentArea.vue'\r\n\r\nexport default {\r\n  components: {\r\n    MapBackground,\r\n    ContentArea\r\n  },\r\n  data() {\r\n    return {\r\n      // 地图配置\r\n      mapConfig: {\r\n        latitude: 30.572815,\r\n        longitude: 104.066801,\r\n        markers: []\r\n      },\r\n      \r\n      // 分类数据\r\n      categories: [\r\n        { id: 'all', name: '全部', active: true },\r\n        { id: 'hot', name: '热门资源', active: false },\r\n        { id: 'exhibition', name: '展会活动', active: false },\r\n        { id: 'personal', name: '个人活动', active: false }\r\n      ],\r\n      activeCategory: 'all',\r\n      \r\n      // 布局相关\r\n      screenHeight: 0,\r\n      contentHeight: 0,\r\n      searchBoxHeight: 0,\r\n      \r\n      // 拖拽相关\r\n      isDragging: false,\r\n      dragStartY: 0,\r\n      dragStartHeight: 0,\r\n      \r\n      // 滚动相关\r\n      lastScrollTop: 0,\r\n      isScrollLocked: false,\r\n      \r\n      // 瀑布流数据\r\n      leftColumnHeights: [],\r\n      rightColumnHeights: [],\r\n      isLoading: false,\r\n      \r\n      // MongoDB数据\r\n      mapPoints: [],\r\n      leftColumnData: [],\r\n      rightColumnData: [],\r\n      \r\n      // 添加分页相关数据\r\n      currentPage: 1,\r\n      pageSize: 10,\r\n      hasMoreData: true\r\n    }\r\n  },\r\n  \r\n  computed: {\r\n    // 计算地图高度\r\n    mapHeight() {\r\n      return this.screenHeight - this.contentHeight\r\n    },\r\n    \r\n    // 最小内容高度（只显示搜索框）\r\n    minContentHeight() {\r\n      return this.searchBoxHeight + LAYOUT_CONFIG.MARGIN\r\n    },\r\n    \r\n    // 最大内容高度\r\n    maxContentHeight() {\r\n      return this.screenHeight * LAYOUT_CONFIG.MAX_CONTENT_RATIO\r\n    }\r\n  },\r\n  \r\n  onReady() {\r\n    this.initLayout()\r\n    this.fetchMapData()\r\n  },\r\n  \r\n  methods: {\r\n    // 初始化布局\r\n    initLayout() {\r\n      const systemInfo = uni.getSystemInfoSync()\r\n      this.screenHeight = systemInfo.windowHeight\r\n      \r\n      // 设置初始内容高度\r\n      this.contentHeight = this.screenHeight * LAYOUT_CONFIG.INITIAL_CONTENT_RATIO\r\n      \r\n      // 设置搜索框高度（固定值）\r\n      this.searchBoxHeight = 80 // 包含拖动条和搜索框的高度\r\n    },\r\n    \r\n    // 从MongoDB获取数据\r\n    // 从MongoDB获取数据\r\n    fetchMapData() {\r\n      this.isLoading = true\r\n      \r\n      // 使用较小的pageSize\r\n      uni.request({\r\n        url: 'http://47.115.220.98:3000/api/map-data',\r\n        method: 'GET',\r\n        data: {\r\n          page: 1,  // 始终获取第一页\r\n          pageSize: 100  // 限制为100条数据\r\n        },\r\n        success: (res) => {\r\n          if (res.statusCode === 200 && res.data) {\r\n            // 在前端过滤数据，只保留距离初始坐标较近的点\r\n            const filteredData = this.filterDataByDistance(res.data, 100);\r\n            this.mapPoints = filteredData;\r\n            \r\n            this.distributeDataToColumns();\r\n            this.updateMapMarkers();\r\n          } else {\r\n            console.error('获取数据失败:', res);\r\n            this.generateRandomData();\r\n          }\r\n        },\r\n        fail: (err) => {\r\n          console.error('请求失败:', err);\r\n          this.generateRandomData();\r\n        },\r\n        complete: () => {\r\n          this.isLoading = false;\r\n        }\r\n      });\r\n    },\r\n    \r\n    // 添加一个方法，根据距离过滤数据\r\n    filterDataByDistance(data, maxCount) {\r\n      if (!data || data.length === 0) return [];\r\n      \r\n      // 计算每个点到初始坐标的距离\r\n      const pointsWithDistance = data.map(point => {\r\n        const distance = this.calculateDistance(\r\n          this.mapConfig.latitude,\r\n          this.mapConfig.longitude,\r\n          point.location.coordinates[1],\r\n          point.location.coordinates[0]\r\n        );\r\n        return { ...point, distance };\r\n      });\r\n      \r\n      // 按距离排序\r\n      pointsWithDistance.sort((a, b) => a.distance - b.distance);\r\n      \r\n      // 只返回最近的maxCount个点\r\n      return pointsWithDistance.slice(0, maxCount);\r\n    },\r\n    \r\n    // 计算两点之间的距离（使用Haversine公式）\r\n    calculateDistance(lat1, lon1, lat2, lon2) {\r\n      const R = 6371000; // 地球半径，单位：米\r\n      const dLat = this.deg2rad(lat2 - lat1);\r\n      const dLon = this.deg2rad(lon2 - lon1);\r\n      const a = \r\n        Math.sin(dLat/2) * Math.sin(dLat/2) +\r\n        Math.cos(this.deg2rad(lat1)) * Math.cos(this.deg2rad(lat2)) * \r\n        Math.sin(dLon/2) * Math.sin(dLon/2);\r\n      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\r\n      const distance = R * c;\r\n      return distance;\r\n    },\r\n    \r\n    deg2rad(deg) {\r\n      return deg * (Math.PI/180);\r\n    },\r\n    // 将数据分配到左右两列\r\n    distributeDataToColumns() {\r\n      if (!this.mapPoints || this.mapPoints.length === 0) {\r\n        return\r\n      }\r\n      \r\n      this.leftColumnData = []\r\n      this.rightColumnData = []\r\n      this.leftColumnHeights = []\r\n      this.rightColumnHeights = []\r\n      \r\n      // 限制最大显示数量，例如每列最多显示10个\r\n      const maxItemsPerColumn = 10\r\n      const totalItems = Math.min(this.mapPoints.length, maxItemsPerColumn * 2)\r\n      \r\n      // 将数据平均分配到左右两列\r\n      for (let index = 0; index < totalItems; index++) {\r\n        const point = this.mapPoints[index]\r\n        // 根据索引交替分配到左右列\r\n        if (index % 2 === 0 && this.leftColumnData.length < maxItemsPerColumn) {\r\n          this.leftColumnData.push(point)\r\n          // 生成随机高度，实际项目中可能需要根据内容动态计算\r\n          this.leftColumnHeights.push(Math.floor(Math.random() * (300 - 150 + 1)) + 150)\r\n        } else if (this.rightColumnData.length < maxItemsPerColumn) {\r\n          this.rightColumnData.push(point)\r\n          this.rightColumnHeights.push(Math.floor(Math.random() * (300 - 150 + 1)) + 150)\r\n        }\r\n      }\r\n    },\r\n    \r\n    data() {\r\n      return {\r\n        // 其他数据...\r\n        markerIcon: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAACXBIWXMAAAsTAAALEwEAmpwYAAABYUlEQVR4nO2WTU7DMBCFn1MWLFjAgiVwAXpAuQFIlQBxCm7AFVBvAKdAIIEQl+AG3IBFJdh0gdjAJKpjOXE6tuNIeNJIkezzm/GMx07TlFJKCTgGboEp8AK8Am/ANzADHoEBcAKsNQYFjoA7/3FRfAD3wEkdyB7w5AP9AkNgF9gGVoCWf7YJdIBz4AT48nMegH3gIIQsA8bAErj0L1+PmNcCzv28JXBVFboLvPuAgyqgOYCBn/8GdIvAu8DCTx5UBcwBDX3OBbBTBL31k0YxkDmgkc+7zYMe+kmPdUBzQGOf+5QFPfeTbuqEZkBvs6Cz/4AWgU6KQP/jqkeBTouKqwx0XgV6HgOdVYGeRkGBTQNHLQp0JxYa7eoYaK8KtB8LHRSBDmOggxjosAg0z1UPgfZioP0i0H4MtFcG2jNwVKKgHQNHLQraMXDUoqAdA0fNwFGLgnYMHLUoaMfAUfsF9Qx5K6QhOhIAAAAASUVORK5CYII='\r\n      }\r\n    },\r\n    \r\n    // 更新地图标记点\r\n    updateMapMarkers() {\r\n      if (!this.mapPoints || this.mapPoints.length === 0) {\r\n        return\r\n      }\r\n      \r\n      const markers = this.mapPoints.map((point, index) => {\r\n        return {\r\n          id: index,\r\n          latitude: point.location.coordinates[1],\r\n          longitude: point.location.coordinates[0],\r\n          // 使用Base64编码的图片\r\n          iconPath: this.markerIcon,\r\n          width: 30,\r\n          height: 30,\r\n          callout: {\r\n            content: point.title,\r\n            color: '#000000',\r\n            fontSize: 12,\r\n            borderRadius: 4,\r\n            padding: 5,\r\n            display: 'BYCLICK'\r\n          }\r\n        }\r\n      })\r\n      \r\n      this.mapConfig.markers = markers\r\n      \r\n      // 如果有数据，将地图中心设置为第一个点的位置\r\n      if (markers.length > 0) {\r\n        this.mapConfig.latitude = markers[0].latitude\r\n        this.mapConfig.longitude = markers[0].longitude\r\n      }\r\n    },\r\n    \r\n    // 生成随机数据（作为备用方案）\r\n    // 修改 generateRandomData 函数\r\n    generateRandomData() {\r\n      // 限制随机生成的数据量\r\n      const maxRandomItems = 10\r\n      this.leftColumnHeights = this.generateRandomHeightsArray(maxRandomItems)\r\n      this.rightColumnHeights = this.generateRandomHeightsArray(maxRandomItems)\r\n    },\r\n    \r\n    // 生成随机高度数据\r\n    generateRandomHeights() {\r\n      this.leftColumnHeights = this.generateRandomHeightsArray(10)\r\n      this.rightColumnHeights = this.generateRandomHeightsArray(10)\r\n    },\r\n    \r\n    // 生成随机高度数组\r\n    generateRandomHeightsArray(count) {\r\n      const heights = []\r\n      for (let i = 0; i < count; i++) {\r\n        // 生成150到300之间的随机高度\r\n        const min = 150\r\n        const max = 300\r\n        const height = Math.floor(Math.random() * (max - min + 1)) + min\r\n        heights.push(height)\r\n      }\r\n      return heights\r\n    },\r\n    \r\n    // 处理拖拽开始\r\n    handleDragStart(e) {\r\n      this.isDragging = true\r\n      this.dragStartY = e.touches[0].clientY\r\n      this.dragStartHeight = this.contentHeight\r\n    },\r\n    \r\n    // 处理拖拽中\r\n    handleDrag(e) {\r\n      if (!this.isDragging) return\r\n      \r\n      const currentY = e.touches[0].clientY\r\n      const deltaY = this.dragStartY - currentY\r\n      \r\n      // 计算新的内容区域高度\r\n      let newHeight = this.dragStartHeight + deltaY\r\n      \r\n      // 限制高度范围\r\n      newHeight = Math.max(\r\n        this.minContentHeight, \r\n        Math.min(this.maxContentHeight, newHeight)\r\n      )\r\n      \r\n      this.contentHeight = newHeight\r\n    },\r\n    \r\n    // 处理拖拽结束\r\n    handleDragEnd() {\r\n      this.isDragging = false\r\n      \r\n      // 添加边界吸附效果，三个状态：只显示搜索框、中间状态、最大高度\r\n      const range = this.maxContentHeight - this.minContentHeight\r\n      const snapThresholds = {\r\n        min: this.minContentHeight + range * LAYOUT_CONFIG.SNAP_THRESHOLD_LOW,\r\n        max: this.minContentHeight + range * LAYOUT_CONFIG.SNAP_THRESHOLD_HIGH\r\n      }\r\n      \r\n      let newHeight\r\n      if (this.contentHeight < snapThresholds.min) {\r\n        // 靠近最小高度，吸附到只显示搜索框的状态\r\n        newHeight = this.minContentHeight\r\n      } else if (this.contentHeight < snapThresholds.max) {\r\n        // 中间状态，吸附到屏幕的1/3\r\n        newHeight = this.screenHeight * LAYOUT_CONFIG.INITIAL_CONTENT_RATIO\r\n      } else {\r\n        // 靠近最大高度，吸附到最大高度\r\n        newHeight = this.maxContentHeight\r\n      }\r\n      \r\n      // 设置高度\r\n      this.contentHeight = newHeight\r\n    },\r\n    \r\n    // 处理瀑布流滚动\r\n    handleWaterfallScroll(e) {\r\n      if (this.isDragging || this.isScrollLocked) return\r\n      \r\n      const currentScrollTop = e.detail.scrollTop\r\n      const deltaY = currentScrollTop - this.lastScrollTop\r\n      \r\n      // 下拉（deltaY > 0）时改变布局\r\n      if (deltaY > 0 && this.contentHeight < this.maxContentHeight) {\r\n        this.handleWaterfallScrollDown(deltaY, currentScrollTop)\r\n      }\r\n      \r\n      this.lastScrollTop = currentScrollTop\r\n    },\r\n    \r\n    // 处理瀑布流向下滚动\r\n    handleWaterfallScrollDown(deltaY, currentScrollTop) {\r\n      // 瀑布流滚动距离与内容区域高度变化比例\r\n      const heightChange = Math.abs(deltaY) / LAYOUT_CONFIG.SCROLL_HEIGHT_RATIO\r\n      \r\n      // 计算新的内容区域高度\r\n      let newHeight = this.contentHeight + heightChange\r\n      newHeight = Math.min(this.maxContentHeight, newHeight)\r\n      \r\n      if (newHeight !== this.contentHeight) {\r\n        // 设置新的内容区域高度\r\n        this.contentHeight = newHeight\r\n        \r\n        // 重置滚动位置，防止瀑布流继续滚动\r\n        this.resetScrollPosition(currentScrollTop, deltaY)\r\n        \r\n        // 暂时锁定滚动，防止连续触发\r\n        this.lockScrollTemporarily()\r\n        \r\n        // 确保内容区域高度是屏幕高度的整数倍数\r\n        if (this.contentHeight > this.screenHeight * 0.5) {\r\n          this.contentHeight = Math.min(\r\n            this.maxContentHeight, \r\n            Math.ceil(this.contentHeight / (this.screenHeight * 0.25)) * (this.screenHeight * 0.25)\r\n          )\r\n        }\r\n      }\r\n    },\r\n    \r\n    // 重置滚动位置\r\n    resetScrollPosition(currentScrollTop, deltaY) {\r\n      // 减少滚动量，保持相对位置\r\n      const newScrollTop = Math.max(0, currentScrollTop + deltaY / LAYOUT_CONFIG.SCROLL_HEIGHT_RATIO)\r\n      \r\n      setTimeout(() => {\r\n        uni.pageScrollTo({\r\n          scrollTop: newScrollTop,\r\n          duration: 0\r\n        })\r\n      }, 0)\r\n    },\r\n    \r\n    // 暂时锁定滚动\r\n    lockScrollTemporarily() {\r\n      this.isScrollLocked = true\r\n      setTimeout(() => {\r\n        this.isScrollLocked = false\r\n      }, LAYOUT_CONFIG.SCROLL_LOCK_DURATION)\r\n    },\r\n    \r\n    // 处理分类切换\r\n    handleCategoryChange(categoryId) {\r\n      this.activeCategory = categoryId\r\n      // 这里可以添加分类切换后的逻辑，如加载对应分类的数据等\r\n    },\r\n    \r\n    // 搜索输入处理\r\n    onSearchInput(e) {\r\n      const searchText = e.detail.value\r\n      // 处理搜索逻辑\r\n    },\r\n    \r\n    // 加载更多内容\r\n    loadMoreItems() {\r\n      if (this.isLoading) return\r\n      \r\n      this.isLoading = true\r\n      \r\n      // 这里可以添加分页加载MongoDB数据的逻辑\r\n      // 示例中使用随机数据模拟\r\n      setTimeout(() => {\r\n        // 为两列各添加5个新卡片\r\n        const newLeftItems = this.generateRandomHeightsArray(5)\r\n        const newRightItems = this.generateRandomHeightsArray(5)\r\n        \r\n        this.leftColumnHeights = [...this.leftColumnHeights, ...newLeftItems]\r\n        this.rightColumnHeights = [...this.rightColumnHeights, ...newRightItems]\r\n        \r\n        this.isLoading = false\r\n      }, 500)\r\n    },\r\n    \r\n    // 获取卡片数据\r\n    getCardData(columnType, index) {\r\n      if (columnType === 'left' && this.leftColumnData[index]) {\r\n        return this.leftColumnData[index]\r\n      } else if (columnType === 'right' && this.rightColumnData[index]) {\r\n        return this.rightColumnData[index]\r\n      }\r\n      return null\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n/* 全局样式 */\r\n.container {\r\n  position: relative;\r\n  height: 100vh;\r\n  width: 100%;\r\n  overflow: hidden;\r\n  background-color: #f0f0f0;\r\n}\r\n</style>","import MiniProgramPage from '/Volumes/是红尘呀/prj/map/map_xy_s_1.0/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["LAYOUT_CONFIG","uni"],"mappings":"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"}